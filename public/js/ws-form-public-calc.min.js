!function(e){"use strict";e.WS_Form.prototype.form_calc_clean=function(){for(var t in this.calc)if(this.calc.hasOwnProperty(t)){var a=this.calc[t],i=this.get_part_id(a.field.id,a.section_repeatable_index,"field-wrapper");if(!e("#"+i,this.form_canvas_obj).length)return this.calc.splice(t,1),void this.form_calc_clean()}},e.WS_Form.prototype.form_calc=function(t,a){for(var i in void 0===t&&(t=!1),void 0===a&&(a=!1),this.calc)if(this.calc.hasOwnProperty(i)){var r=this.calc[i];if(!1!==a){if(-1!==r.value.indexOf("#section_row_count")){this.form_calc_do(r,"#section_row_count");continue}if(-1!==r.value.indexOf("#section_row_index")){this.form_calc_do(r,"#section_row_index");continue}var _=r.field.section_id;if(parseInt(_)===parseInt(a,10)){this.form_calc_do(r,r.field.id);continue}if(!1===r.section_repeatable_index)for(var s in r.field_ids_touched)if(r.field_ids_touched.hasOwnProperty(s)){var c=r.field_ids_touched[s],d=this.field_data_cache[c],o=void 0!==d.section_repeatable_section_id&&d.section_repeatable_section_id;parseInt(o)===parseInt(a,10)&&this.form_calc_do(r,c)}}else if(!1!==t){var n=e("#"+t,this.form_canvas_obj),l=n.attr("data-id-hidden"),f=l?n:n.closest("[data-id]"),p=l?parseInt(l,10):parseInt(f.attr("data-id"),10);if(p===r.field.id&&"value"==r.field_part)continue;var m=r.field_ids_touched;m.length>0&&-1!==m.indexOf(p)&&this.form_calc_do(r,p)}else this.form_calc_do(r,e.WS_Form.debug_rendered?this.language("log_"+r.type+"_init"):"")}},e.WS_Form.prototype.form_calc_do=function(t,a){if(this.log("log_"+t.type+"_fired",t.field.label+" - "+this.html_encode(t.value)+(a?" ("+this.language("log_"+t.type+"_fired_triggered",a)+")":""),t.type),void 0!==e.WS_Form.field_type_cache[t.field.type]){var i=e.WS_Form.field_type_cache[t.field.type];if(i[t.type+"_in"],i[t.type+"_in"]){var r=this.parse_variables_process(t.value,t.section_repeatable_index,t.type,t.field,t.field_part,!1).output;switch(t.field_part){case"field_text_editor":case"field_html":var _=this.get_part_id(t.field.id,t.section_repeatable_index,"field-wrapper");(l=e("["+("field_text_editor"==t.field_part?"data-text-editor":"data-html")+"]",e("#"+_,this.form_canvas_obj))).html(r);break;case"field_label":var s=this.get_part_id(t.field.id,t.section_repeatable_index,"label"),c=(l=e("#"+s,this.form_canvas_obj)).children(".wsf-required-wrapper");l.html(r),c&&l.append(c);break;case"field_help":var d=this.get_part_id(t.field.id,t.section_repeatable_index,"help");(l=e("#"+d,this.form_canvas_obj)).html(r);break;case"field_placeholder":case"field_min":case"field_max":switch(t.field_part){case"field_min":case"field_max":var o=this.get_number(r,0,!1);o%1==0||"range"!==t.field.type&&"price_range"!==t.field.type||(r=this.get_number_rounded(o,8))}var n=this.get_part_id(t.field.id,t.section_repeatable_index),l=e("#"+n,this.form_canvas_obj),f=t.field_part.substring(6),p=l.attr(f);l.attr(f,r),"function"==typeof this.form_date_datetimepicker_enabled&&this.form_date_datetimepicker_enabled()&&"datetime"===t.field.type&&(l.datetimepicker("destroy"),"function"==typeof this.form_date_process&&this.form_date_process(l)),p!==l.attr(f)&&l.trigger("change");break;case"field_ecommerce_price_min":case"field_ecommerce_price_max":n=this.get_part_id(t.field.id,t.section_repeatable_index),l=e("#"+n,this.form_canvas_obj),f=t.field_part.substring(6),p=l.attr(f);l.attr("data-ecommerce-"+("field_ecommerce_price_min"===t.field_part?"min":"max"),r),"function"==typeof this.form_ecommerce_input_mask_currency&&this.form_ecommerce_input_mask_currency(l),p!==l.attr(f)&&l.trigger("change");break;case"field_value":n=this.get_part_id(t.field.id,t.section_repeatable_index),l=e("#"+n,this.form_canvas_obj);var m=h=u=!1;switch(t.field.type){case"progress":case"range":case"price_range":(r=this.get_number(r,0,!1))%1==0||"range"!==t.field.type&&"price_range"!==t.field.type||(r=this.get_number_rounded(r,8));m=void 0!==l.attr("min")?l.attr("min"):0;var h=void 0!==l.attr("max")?l.attr("max"):100,u=void 0!==l.attr("step")?l.attr("step"):1;break;case"price":case"price_subtotal":case"cart_price":case"number":case"quantity":case"wc_quantity":r=this.get_number(r,0,!1);m=void 0!==l.attr("min")?l.attr("min"):m,h=void 0!==l.attr("max")?l.attr("max"):h,u=void 0!==l.attr("step")?l.attr("step"):u;break;case"datetime":if("calc"===t.type)if((r=this.get_number(r,0,!0))>0){var g=l.attr("data-date-format")?l.attr("data-date-format"):ws_form_settings.date_format,b=l.attr("data-time-format")?l.attr("data-time-format"):ws_form_settings.time_format;switch(l.attr("data-date-type")){case"date":var v=g;break;case"time":v=b;break;case"month":v="F Y";break;case"week":var y="";ws_this.language("week").split("").map(e=>{y+="\\"+e});v=y+" W, Y";break;default:v=g+" "+b}r="function"==typeof this.date_format?this.date_format(new Date(1e3*r),v):""}else r=""}switch(!1!==m&&r<m&&(r=m),!1!==h&&r>h&&(r=h),!1!==u&&(r=this.get_number_to_step(r,u)),t.field.type){case"price":case"price_range":case"price_subtotal":case"cart_price":var x=this.get_number(l.val(),0,!0)!==r;r=this.get_price(r);break;case"progress":case"range":case"number":case"quantity":case"wc_quantity":x=this.get_number(l.val(),0,!1)!==r;break;default:x=l.val()!==r}switch(t.field.type){case"progress":this.form_progress_set_value(l,r);break;case"price":case"price_range":case"price_subtotal":case"cart_price":l.val(r),x&&l.trigger("change");break;default:l.val(r),r==l.val()&&x&&l.trigger("change")}}}else this.error("error_parse_variable_syntax_error_"+t.type+"_in","ID: "+t.field.id,"parse-variables")}}}(jQuery);